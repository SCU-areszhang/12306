# 12306 é¡¹ç›®ç¯å¢ƒåˆå§‹åŒ–æŒ‡å—

æœ¬æ–‡æ¡£å°†æŒ‡å¯¼æ‚¨å¦‚ä½•åˆå§‹åŒ– MySQLã€Redis å’Œ RocketMQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ç¯å¢ƒã€‚

## ğŸ“‹ ç›®å½•

1. [MySQL åˆå§‹åŒ–](#1-mysql-åˆå§‹åŒ–)
2. [Redis åˆå§‹åŒ–](#2-redis-åˆå§‹åŒ–)
3. [RocketMQ åˆå§‹åŒ–](#3-rocketmq-åˆå§‹åŒ–)
4. [éªŒè¯é…ç½®](#4-éªŒè¯é…ç½®)

---

## 1. MySQL åˆå§‹åŒ–

### 1.1 å®‰è£… MySQL

**Windows ç³»ç»Ÿï¼š**
- ä¸‹è½½ MySQL 8.0+ å®‰è£…åŒ…ï¼šhttps://dev.mysql.com/downloads/mysql/
- å®‰è£…æ—¶è®¾ç½® root ç”¨æˆ·å¯†ç ä¸ºï¼š`root`ï¼ˆä¸é…ç½®æ–‡ä»¶ä¸€è‡´ï¼‰

**ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰ï¼š**
```bash
docker run -d \
  --name mysql-12306 \
  -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=12306_ticket \
  mysql:8.0
```

### 1.2 åˆ›å»ºæ•°æ®åº“

æ ¹æ®é¡¹ç›®é…ç½®ï¼Œéœ€è¦åˆ›å»ºä»¥ä¸‹æ•°æ®åº“ï¼š

```sql
-- åˆ›å»ºè´­ç¥¨æœåŠ¡æ•°æ®åº“
CREATE DATABASE IF NOT EXISTS `12306_ticket` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºç”¨æˆ·æœåŠ¡æ•°æ®åº“ï¼ˆåˆ†åº“åˆ†è¡¨ï¼‰
CREATE DATABASE IF NOT EXISTS `12306_user_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_user_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºè®¢å•æœåŠ¡æ•°æ®åº“ï¼ˆåˆ†åº“åˆ†è¡¨ï¼‰
CREATE DATABASE IF NOT EXISTS `12306_order_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_order_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºæ”¯ä»˜æœåŠ¡æ•°æ®åº“ï¼ˆåˆ†åº“åˆ†è¡¨ï¼‰
CREATE DATABASE IF NOT EXISTS `12306_pay_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_pay_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 1.3 æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬

é¡¹ç›®æä¾›äº†ä¸¤ç§ç‰ˆæœ¬çš„ SQL è„šæœ¬ï¼š

**SpringBoot èšåˆç‰ˆæœ¬ï¼š**
```bash
# æ‰§è¡Œèšåˆç‰ˆæœ¬çš„ SQL è„šæœ¬
mysql -uroot -proot < resources/db/12306-springboot.sql
```

**SpringCloud å¾®æœåŠ¡ç‰ˆæœ¬ï¼š**
```bash
# æ‰§è¡Œå„æœåŠ¡çš„ SQL è„šæœ¬
mysql -uroot -proot < resources/db/12306-springcloud-ticket.sql
mysql -uroot -proot < resources/db/12306-springcloud-user.sql
mysql -uroot -proot < resources/db/12306-springcloud-order.sql
mysql -uroot -proot < resources/db/12306-springcloud-pay.sql
```

**æˆ–è€…ä½¿ç”¨ MySQL Workbench / Navicat ç­‰å·¥å…·ï¼š**
- æ‰“å¼€å¯¹åº”çš„ SQL æ–‡ä»¶
- é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“
- æ‰§è¡Œè„šæœ¬

### 1.4 éªŒè¯ MySQL é…ç½®

é…ç½®æ–‡ä»¶ä¸­çš„ MySQL è¿æ¥ä¿¡æ¯ï¼š
- **ä¸»æœº**: `127.0.0.1`
- **ç«¯å£**: `3306`
- **ç”¨æˆ·å**: `root`
- **å¯†ç **: `root`

æµ‹è¯•è¿æ¥ï¼š
```bash
mysql -h 127.0.0.1 -P 3306 -u root -proot
```

---

## 2. Redis åˆå§‹åŒ–

### 2.1 å®‰è£… Redis

**Windows ç³»ç»Ÿï¼š**
- ä¸‹è½½ Redis for Windowsï¼šhttps://github.com/microsoftarchive/redis/releases
- æˆ–ä½¿ç”¨ WSL2 å®‰è£… Redis

**ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰ï¼š**
```bash
docker run -d \
  --name redis-12306 \
  -p 6379:6379 \
  redis:7-alpine \
  redis-server --requirepass 123456
```

**macOSï¼š**
```bash
brew install redis
brew services start redis
redis-cli
CONFIG SET requirepass 123456
```

**Linuxï¼š**
```bash
# Ubuntu/Debian
sudo apt-get install redis-server
sudo systemctl start redis-server
redis-cli
CONFIG SET requirepass 123456
```

### 2.2 é…ç½® Redis å¯†ç 

é¡¹ç›®é…ç½®è¦æ±‚ Redis å¯†ç ä¸ºï¼š`123456`

å¦‚æœ Redis å·²å®‰è£…ä½†æœªè®¾ç½®å¯†ç ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¾ç½®ï¼š

```bash
# æ–¹å¼1ï¼šé€šè¿‡ redis-cli è®¾ç½®
redis-cli
CONFIG SET requirepass 123456
CONFIG REWRITE  # æŒä¹…åŒ–åˆ°é…ç½®æ–‡ä»¶

# æ–¹å¼2ï¼šä¿®æ”¹ redis.conf æ–‡ä»¶
requirepass 123456
```

### 2.3 éªŒè¯ Redis é…ç½®

é…ç½®æ–‡ä»¶ä¸­çš„ Redis è¿æ¥ä¿¡æ¯ï¼š
- **ä¸»æœº**: `127.0.0.1`
- **ç«¯å£**: `6379`
- **å¯†ç **: `123456`

æµ‹è¯•è¿æ¥ï¼š
```bash
redis-cli -h 127.0.0.1 -p 6379 -a 123456
ping
# åº”è¯¥è¿”å› PONG
```

---

## 3. RocketMQ åˆå§‹åŒ–

**æ³¨æ„**ï¼šé¡¹ç›®ä½¿ç”¨çš„æ˜¯ **RocketMQ**ï¼Œè€Œä¸æ˜¯ RabbitMQã€‚

### 3.1 å®‰è£… RocketMQ

**ä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰ï¼š**
```bash
# å¯åŠ¨ NameServer
docker run -d \
  --name rocketmq-nameserver \
  -p 9876:9876 \
  apache/rocketmq:5.1.4 \
  sh mqnamesrv

# å¯åŠ¨ Broker
docker run -d \
  --name rocketmq-broker \
  -p 10909:10909 \
  -p 10911:10911 \
  -e "NAMESRV_ADDR=127.0.0.1:9876" \
  apache/rocketmq:5.1.4 \
  sh mqbroker -n 127.0.0.1:9876
```

**æˆ–è€…ä½¿ç”¨ Docker Composeï¼ˆæ›´ç®€å•ï¼‰ï¼š**
åˆ›å»º `docker-compose-rocketmq.yml` æ–‡ä»¶ï¼š

```yaml
version: '3.8'
services:
  rocketmq-nameserver:
    image: apache/rocketmq:5.1.4
    container_name: rocketmq-nameserver
    ports:
      - "9876:9876"
    command: sh mqnamesrv

  rocketmq-broker:
    image: apache/rocketmq:5.1.4
    container_name: rocketmq-broker
    ports:
      - "10909:10909"
      - "10911:10911"
    environment:
      - NAMESRV_ADDR=rocketmq-nameserver:9876
    depends_on:
      - rocketmq-nameserver
    command: sh mqbroker -n rocketmq-nameserver:9876
```

ç„¶åè¿è¡Œï¼š
```bash
docker-compose -f docker-compose-rocketmq.yml up -d
```

**æ‰‹åŠ¨å®‰è£…ï¼ˆLinux/macOSï¼‰ï¼š**
1. ä¸‹è½½ RocketMQï¼šhttps://rocketmq.apache.org/download
2. è§£å‹å¹¶å¯åŠ¨ï¼š
```bash
# å¯åŠ¨ NameServer
nohup sh bin/mqnamesrv &

# å¯åŠ¨ Broker
nohup sh bin/mqbroker -n localhost:9876 &
```

### 3.2 éªŒè¯ RocketMQ é…ç½®

é…ç½®æ–‡ä»¶ä¸­çš„ RocketMQ è¿æ¥ä¿¡æ¯ï¼š
- **NameServer åœ°å€**: `127.0.0.1:9876`

æµ‹è¯•è¿æ¥ï¼š
```bash
# æŸ¥çœ‹ NameServer æ—¥å¿—
docker logs rocketmq-nameserver

# æŸ¥çœ‹ Broker æ—¥å¿—
docker logs rocketmq-broker

# æˆ–ä½¿ç”¨ RocketMQ æ§åˆ¶å°ï¼ˆå¯é€‰ï¼‰
# è®¿é—® http://localhost:8080ï¼ˆéœ€è¦å•ç‹¬éƒ¨ç½²æ§åˆ¶å°ï¼‰
```

---

## 4. éªŒè¯é…ç½®

### 4.1 æ£€æŸ¥æœåŠ¡çŠ¶æ€

**MySQLï¼š**
```bash
mysql -h 127.0.0.1 -P 3306 -u root -proot -e "SHOW DATABASES;"
```

**Redisï¼š**
```bash
redis-cli -h 127.0.0.1 -p 6379 -a 123456 ping
```

**RocketMQï¼š**
```bash
# æ£€æŸ¥ NameServer ç«¯å£
netstat -an | grep 9876
# æˆ–
docker ps | grep rocketmq
```

### 4.2 é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

ç¡®ä¿ä»¥ä¸‹é…ç½®æ–‡ä»¶ä¸­çš„è¿æ¥ä¿¡æ¯æ­£ç¡®ï¼š

| æœåŠ¡ | é…ç½®é¡¹ | å€¼ |
|------|-------|-----|
| MySQL | host:port | 127.0.0.1:3306 |
| MySQL | username:password | root:root |
| Redis | host:port | 127.0.0.1:6379 |
| Redis | password | 123456 |
| RocketMQ | name-server | 127.0.0.1:9876 |

### 4.3 å¯åŠ¨é¡¹ç›®éªŒè¯

å®Œæˆä»¥ä¸Šåˆå§‹åŒ–åï¼Œå¯ä»¥å°è¯•å¯åŠ¨é¡¹ç›®ï¼š

1. **SpringBoot èšåˆç‰ˆæœ¬**ï¼šå¯åŠ¨ `aggregation-service`
2. **SpringCloud å¾®æœåŠ¡ç‰ˆæœ¬**ï¼šä¾æ¬¡å¯åŠ¨å„æœåŠ¡

å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œæ£€æŸ¥æ—¥å¿—ä¸­çš„è¿æ¥é”™è¯¯ä¿¡æ¯ã€‚

---

## 5. å¸¸è§é—®é¢˜

### Q1: MySQL è¿æ¥å¤±è´¥
- æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ï¼ˆroot/rootï¼‰
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 3306 ç«¯å£

### Q2: Redis è¿æ¥å¤±è´¥
- æ£€æŸ¥ Redis æœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤å¯†ç æ˜¯å¦æ­£ç¡®ï¼ˆ123456ï¼‰
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 6379 ç«¯å£

### Q3: RocketMQ è¿æ¥å¤±è´¥
- ç¡®è®¤ NameServer å·²å¯åŠ¨ï¼ˆç«¯å£ 9876ï¼‰
- ç¡®è®¤ Broker å·²å¯åŠ¨ï¼ˆç«¯å£ 10909, 10911ï¼‰
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### Q4: æ•°æ®åº“è„šæœ¬æ‰§è¡Œå¤±è´¥
- ç¡®è®¤æ•°æ®åº“å·²åˆ›å»º
- æ£€æŸ¥å­—ç¬¦é›†æ˜¯å¦ä¸º utf8mb4
- ç¡®è®¤ SQL æ–‡ä»¶è·¯å¾„æ­£ç¡®

---

## 6. å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆDockerï¼‰

å¦‚æœæ‚¨ä½¿ç”¨ Dockerï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿå¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼š

```bash
# MySQL
docker run -d --name mysql-12306 -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=12306_ticket \
  mysql:8.0

# Redis
docker run -d --name redis-12306 -p 6379:6379 \
  redis:7-alpine redis-server --requirepass 123456

# RocketMQ NameServer
docker run -d --name rocketmq-nameserver -p 9876:9876 \
  apache/rocketmq:5.1.4 sh mqnamesrv

# RocketMQ Broker
docker run -d --name rocketmq-broker -p 10909:10909 -p 10911:10911 \
  -e "NAMESRV_ADDR=127.0.0.1:9876" \
  apache/rocketmq:5.1.4 sh mqbroker -n 127.0.0.1:9876
```

---

## 7. ä¸‹ä¸€æ­¥

å®Œæˆç¯å¢ƒåˆå§‹åŒ–åï¼Œæ‚¨å¯ä»¥ï¼š
1. æŸ¥çœ‹ README.md äº†è§£é¡¹ç›®ç»“æ„
2. å¯åŠ¨åç«¯æœåŠ¡
3. å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆconsole-vueï¼‰
4. è®¿é—®é¡¹ç›®æ–‡æ¡£ï¼šhttps://nageoffer.com/12306

ç¥æ‚¨å­¦ä¹ æ„‰å¿«ï¼ğŸš€


# 12306 å¾®æœåŠ¡é¡¹ç›®å¯åŠ¨æŒ‡å—

> æœ¬æ–‡æ¡£ä¸“ä¸ºå¾®æœåŠ¡åˆå­¦è€…ç¼–å†™ï¼Œæä¾›è¯¦ç»†çš„æ­¥éª¤è¯´æ˜ï¼Œå¸®åŠ©æ‚¨ä»é›¶å¼€å§‹å¯åŠ¨æ•´ä¸ª 12306 å¾®æœåŠ¡é¡¹ç›®ã€‚

## ğŸ“š ç›®å½•

- [ä¸€ã€é¡¹ç›®æ¶æ„æ¦‚è§ˆ](#ä¸€é¡¹ç›®æ¶æ„æ¦‚è§ˆ)
- [äºŒã€ç¯å¢ƒå‡†å¤‡](#äºŒç¯å¢ƒå‡†å¤‡)
- [ä¸‰ã€ä¸­é—´ä»¶åˆå§‹åŒ–](#ä¸‰ä¸­é—´ä»¶åˆå§‹åŒ–)
- [å››ã€æ•°æ®åº“åˆå§‹åŒ–](#å››æ•°æ®åº“åˆå§‹åŒ–)
- [äº”ã€é¡¹ç›®å¯åŠ¨æ–¹å¼](#äº”é¡¹ç›®å¯åŠ¨æ–¹å¼)
- [å…­ã€å¯åŠ¨éªŒè¯](#å…­å¯åŠ¨éªŒè¯)
- [ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥](#ä¸ƒå¸¸è§é—®é¢˜æ’æŸ¥)

---

## ä¸€ã€é¡¹ç›®æ¶æ„æ¦‚è§ˆ

### 1.1 é¡¹ç›®ç»“æ„

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº **SpringCloud Alibaba** çš„å¾®æœåŠ¡æ¶æ„é¡¹ç›®ï¼ŒåŒ…å«ä»¥ä¸‹æœåŠ¡ï¼š

```
12306 é¡¹ç›®
â”œâ”€â”€ services/                    # å¾®æœåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ gateway-service/         # ç½‘å…³æœåŠ¡ï¼ˆç«¯å£ï¼š9000ï¼‰
â”‚   â”œâ”€â”€ user-service/            # ç”¨æˆ·æœåŠ¡ï¼ˆç«¯å£ï¼š9001ï¼‰
â”‚   â”œâ”€â”€ ticket-service/          # è´­ç¥¨æœåŠ¡ï¼ˆç«¯å£ï¼š9002ï¼‰
â”‚   â”œâ”€â”€ order-service/           # è®¢å•æœåŠ¡ï¼ˆç«¯å£ï¼š9003ï¼‰
â”‚   â”œâ”€â”€ pay-service/             # æ”¯ä»˜æœåŠ¡ï¼ˆç«¯å£ï¼š9004ï¼‰
â”‚   â””â”€â”€ aggregation-service/     # èšåˆæœåŠ¡ï¼ˆç«¯å£ï¼š9005ï¼‰
â”œâ”€â”€ frameworks/                  # æ¡†æ¶åŸºç¡€æ¨¡å—
â””â”€â”€ dependencies/                # ä¾èµ–ç®¡ç†æ¨¡å—
```

### 1.2 æœåŠ¡ç«¯å£åˆ†é…

| æœåŠ¡åç§° | ç«¯å£ | è¯´æ˜ |
|---------|------|------|
| gateway-service | 9000 | API ç½‘å…³ï¼Œæ‰€æœ‰è¯·æ±‚çš„å…¥å£ |
| user-service | 9001 | ç”¨æˆ·æœåŠ¡ï¼ˆæ³¨å†Œã€ç™»å½•ã€ä¹˜è½¦äººç®¡ç†ï¼‰ |
| ticket-service | 9002 | è´­ç¥¨æœåŠ¡ï¼ˆè½¦ç¥¨æŸ¥è¯¢ã€è´­ä¹°ï¼‰ |
| order-service | 9003 | è®¢å•æœåŠ¡ï¼ˆè®¢å•ç®¡ç†ï¼‰ |
| pay-service | 9004 | æ”¯ä»˜æœåŠ¡ï¼ˆæ”¯ä»˜å¤„ç†ï¼‰ |
| aggregation-service | 9005 | èšåˆæœåŠ¡ï¼ˆèšåˆæ‰€æœ‰ä¸šåŠ¡æœåŠ¡ï¼‰ |

### 1.3 ä¸¤ç§å¯åŠ¨æ¨¡å¼

é¡¹ç›®æä¾›äº†ä¸¤ç§å¯åŠ¨æ¨¡å¼ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š

#### æ¨¡å¼ä¸€ï¼šSpringCloud å¾®æœåŠ¡æ¨¡å¼ï¼ˆæ¨èå­¦ä¹ ï¼‰
- **ç‰¹ç‚¹**ï¼šæ¯ä¸ªæœåŠ¡ç‹¬ç«‹å¯åŠ¨ï¼Œå®Œå…¨ç¬¦åˆå¾®æœåŠ¡æ¶æ„
- **é€‚ç”¨åœºæ™¯**ï¼šå­¦ä¹ å¾®æœåŠ¡æ¶æ„ã€æœåŠ¡é—´è°ƒç”¨ã€åˆ†å¸ƒå¼äº‹åŠ¡ç­‰
- **éœ€è¦å¯åŠ¨çš„æœåŠ¡**ï¼š
  1. Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼‰
  2. user-service
  3. ticket-service
  4. order-service
  5. pay-service
  6. gateway-service

#### æ¨¡å¼äºŒï¼šSpringBoot èšåˆæ¨¡å¼ï¼ˆæ¨èæµ‹è¯•ï¼‰
- **ç‰¹ç‚¹**ï¼šæ‰€æœ‰ä¸šåŠ¡æœåŠ¡èšåˆåˆ°ä¸€ä¸ªæœåŠ¡ä¸­ï¼Œä¾¿äºæµ‹è¯•å’Œéƒ¨ç½²
- **é€‚ç”¨åœºæ™¯**ï¼šå¿«é€Ÿæµ‹è¯•ã€åŠŸèƒ½éªŒè¯ã€å•æœºéƒ¨ç½²
- **éœ€è¦å¯åŠ¨çš„æœåŠ¡**ï¼š
  1. Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼‰
  2. aggregation-service
  3. gateway-service

---

## äºŒã€ç¯å¢ƒå‡†å¤‡

### 2.1 å¿…éœ€è½¯ä»¶æ¸…å•

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„å¼€å‘ç¯å¢ƒå·²å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|---------|------|
| JDK | 17+ | Java å¼€å‘ç¯å¢ƒ |
| Maven | 3.6+ | é¡¹ç›®æ„å»ºå·¥å…· |
| MySQL | 8.0+ | æ•°æ®åº“ |
| Redis | 6.0+ | ç¼“å­˜ |
| RocketMQ | 5.0+ | æ¶ˆæ¯é˜Ÿåˆ— |
| Nacos | 2.0+ | æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸­å¿ƒ |

### 2.2 æ£€æŸ¥ç¯å¢ƒ

#### æ£€æŸ¥ JDK ç‰ˆæœ¬
```bash
java -version
# åº”è¯¥æ˜¾ç¤ºï¼šopenjdk version "17" æˆ–æ›´é«˜ç‰ˆæœ¬
```

#### æ£€æŸ¥ Maven ç‰ˆæœ¬
```bash
mvn -version
# åº”è¯¥æ˜¾ç¤ºï¼šApache Maven 3.6.x æˆ–æ›´é«˜ç‰ˆæœ¬
```

#### æ£€æŸ¥ç«¯å£å ç”¨æƒ…å†µ
```bash
# Windows
netstat -ano | findstr "9000 9001 9002 9003 9004 9005 3306 6379 9876 8848"

# Linux/macOS
netstat -tuln | grep -E "9000|9001|9002|9003|9004|9005|3306|6379|9876|8848"
```

å¦‚æœç«¯å£è¢«å ç”¨ï¼Œéœ€è¦ï¼š
1. å…³é—­å ç”¨ç«¯å£çš„ç¨‹åº
2. æˆ–è€…ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·

---

## ä¸‰ã€ä¸­é—´ä»¶åˆå§‹åŒ–

### 3.1 å¯åŠ¨é¡ºåºè¯´æ˜

**é‡è¦**ï¼šä¸­é—´ä»¶å¿…é¡»æŒ‰ç…§ä»¥ä¸‹é¡ºåºå¯åŠ¨ï¼Œå› ä¸ºæœåŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼

```
1. MySQLï¼ˆæ•°æ®åº“ï¼‰
   â†“
2. Redisï¼ˆç¼“å­˜ï¼‰
   â†“
3. RocketMQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰
   â†“
4. Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰
   â†“
5. ä¸šåŠ¡å¾®æœåŠ¡
   â†“
6. Gatewayï¼ˆç½‘å…³ï¼‰
```

### 3.2 MySQL å¯åŠ¨ä¸é…ç½®

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
docker run -d \
  --name mysql-12306 \
  -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=12306_ticket \
  mysql:8.0
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°å®‰è£…

1. ä¸‹è½½å¹¶å®‰è£… MySQL 8.0+
2. è®¾ç½® root å¯†ç ä¸ºï¼š`root`
3. å¯åŠ¨ MySQL æœåŠ¡

#### éªŒè¯ MySQL è¿æ¥

```bash
mysql -h 127.0.0.1 -P 3306 -u root -proot
```

å¦‚æœè¿æ¥æˆåŠŸï¼Œè¯´æ˜ MySQL å·²å°±ç»ªã€‚

### 3.3 Redis å¯åŠ¨ä¸é…ç½®

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
docker run -d \
  --name redis-12306 \
  -p 6379:6379 \
  redis:7-alpine \
  redis-server --requirepass 123456
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°å®‰è£…

1. ä¸‹è½½å¹¶å®‰è£… Redis
2. è®¾ç½®å¯†ç ä¸ºï¼š`123456`
3. å¯åŠ¨ Redis æœåŠ¡

#### éªŒè¯ Redis è¿æ¥

```bash
redis-cli -h 127.0.0.1 -p 6379 -a 123456 ping
# åº”è¯¥è¿”å›ï¼šPONG
```

### 3.4 RocketMQ å¯åŠ¨ä¸é…ç½®

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨ NameServer
docker run -d \
  --name rocketmq-nameserver \
  -p 9876:9876 \
  apache/rocketmq:5.1.4 \
  sh mqnamesrv

# å¯åŠ¨ Broker
docker run -d \
  --name rocketmq-broker \
  -p 10909:10909 \
  -p 10911:10911 \
  -e "NAMESRV_ADDR=127.0.0.1:9876" \
  apache/rocketmq:5.1.4 \
  sh mqbroker -n 127.0.0.1:9876
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°å®‰è£…

1. ä¸‹è½½ RocketMQï¼šhttps://rocketmq.apache.org/download
2. è§£å‹åå¯åŠ¨ï¼š

```bash
# å¯åŠ¨ NameServer
cd rocketmq/bin
nohup sh mqnamesrv &

# å¯åŠ¨ Broker
nohup sh mqbroker -n localhost:9876 &
```

#### éªŒè¯ RocketMQ

```bash
# æ£€æŸ¥ NameServer æ—¥å¿—
docker logs rocketmq-nameserver
# åº”è¯¥çœ‹åˆ°ï¼šThe Name Server boot success

# æ£€æŸ¥ Broker æ—¥å¿—
docker logs rocketmq-broker
# åº”è¯¥çœ‹åˆ°ï¼šThe broker boot success
```

### 3.5 Nacos å¯åŠ¨ä¸é…ç½®

**Nacos æ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ‰€æœ‰å¾®æœåŠ¡éƒ½éœ€è¦æ³¨å†Œåˆ°è¿™é‡Œï¼**

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Dockerï¼ˆæ¨èï¼‰

```bash
docker run -d \
  --name nacos-server \
  -p 8848:8848 \
  -e MODE=standalone \
  -e PREFER_HOST_MODE=hostname \
  nacos/nacos-server:v2.2.3
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°å®‰è£…

1. ä¸‹è½½ Nacosï¼šhttps://github.com/alibaba/nacos/releases
2. è§£å‹åå¯åŠ¨ï¼š

```bash
# Windows
startup.cmd -m standalone

# Linux/macOS
sh startup.sh -m standalone
```

#### è®¿é—® Nacos æ§åˆ¶å°

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://127.0.0.1:8848/nacos
2. é»˜è®¤ç”¨æˆ·å/å¯†ç ï¼š`nacos/nacos`
3. ç™»å½•åï¼Œåœ¨"æœåŠ¡ç®¡ç† -> æœåŠ¡åˆ—è¡¨"ä¸­å¯ä»¥çœ‹åˆ°å·²æ³¨å†Œçš„æœåŠ¡

#### éªŒè¯ Nacos

```bash
# æ£€æŸ¥ Nacos æ˜¯å¦å¯åŠ¨
curl http://127.0.0.1:8848/nacos/v1/console/health
# åº”è¯¥è¿”å›ï¼š{"status":"UP"}
```

---

## å››ã€æ•°æ®åº“åˆå§‹åŒ–

### 4.1 åˆ›å»ºæ•°æ®åº“

æ ¹æ®æ‚¨é€‰æ‹©çš„å¯åŠ¨æ¨¡å¼ï¼Œæ‰§è¡Œå¯¹åº”çš„ SQL è„šæœ¬ï¼š

#### å¾®æœåŠ¡æ¨¡å¼ï¼ˆéœ€è¦åˆ›å»ºå¤šä¸ªæ•°æ®åº“ï¼‰

```sql
-- è¿æ¥åˆ° MySQL
mysql -u root -proot

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE IF NOT EXISTS `12306_ticket` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_user_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_user_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_order_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_order_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_pay_0` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE DATABASE IF NOT EXISTS `12306_pay_1` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### èšåˆæ¨¡å¼ï¼ˆåªéœ€è¦ä¸€ä¸ªæ•°æ®åº“ï¼‰

```sql
CREATE DATABASE IF NOT EXISTS `12306_ticket` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
-- èšåˆæ¨¡å¼ä¼šä½¿ç”¨åˆ†åº“åˆ†è¡¨ï¼Œå…¶ä»–æ•°æ®åº“ä¹Ÿä¼šè‡ªåŠ¨åˆ›å»º
```

### 4.2 æ‰§è¡Œ SQL è„šæœ¬

#### å¾®æœåŠ¡æ¨¡å¼

```bash
# æ‰§è¡Œå„æœåŠ¡çš„ SQL è„šæœ¬
mysql -uroot -proot < resources/db/12306-springcloud-ticket.sql
mysql -uroot -proot < resources/db/12306-springcloud-user.sql
mysql -uroot -proot < resources/db/12306-springcloud-order.sql
mysql -uroot -proot < resources/db/12306-springcloud-pay.sql
```

#### èšåˆæ¨¡å¼

```bash
# æ‰§è¡Œèšåˆæ¨¡å¼çš„ SQL è„šæœ¬
mysql -uroot -proot < resources/db/12306-springboot.sql
```

**æˆ–è€…ä½¿ç”¨ MySQL Workbench / Navicatï¼š**
1. æ‰“å¼€å¯¹åº”çš„ SQL æ–‡ä»¶
2. é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“
3. æ‰§è¡Œè„šæœ¬

### 4.3 éªŒè¯æ•°æ®åº“

```bash
# æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦åˆ›å»ºæˆåŠŸ
mysql -uroot -proot -e "SHOW DATABASES;"

# æŸ¥çœ‹è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸï¼ˆä»¥ ticket æœåŠ¡ä¸ºä¾‹ï¼‰
mysql -uroot -proot -e "USE 12306_ticket; SHOW TABLES;"
```

---

## äº”ã€é¡¹ç›®å¯åŠ¨æ–¹å¼

### 5.1 ç¼–è¯‘é¡¹ç›®

åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦å…ˆç¼–è¯‘æ•´ä¸ªé¡¹ç›®ï¼š

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
mvn clean install -DskipTests
```

**è¯´æ˜**ï¼š
- `clean`ï¼šæ¸…ç†ä¹‹å‰çš„ç¼–è¯‘æ–‡ä»¶
- `install`ï¼šç¼–è¯‘å¹¶å®‰è£…åˆ°æœ¬åœ°ä»“åº“
- `-DskipTests`ï¼šè·³è¿‡æµ‹è¯•ï¼ˆåŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼‰

**ç¼–è¯‘æ—¶é—´**ï¼šé¦–æ¬¡ç¼–è¯‘å¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿï¼Œå› ä¸ºéœ€è¦ä¸‹è½½ä¾èµ–ã€‚

### 5.2 æ–¹å¼ä¸€ï¼šSpringCloud å¾®æœåŠ¡æ¨¡å¼å¯åŠ¨

#### å¯åŠ¨æ­¥éª¤ï¼ˆæŒ‰é¡ºåºï¼‰

**ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ Nacos**
```bash
# å¦‚æœä½¿ç”¨ Dockerï¼Œç¡®ä¿ Nacos å®¹å™¨æ­£åœ¨è¿è¡Œ
docker ps | grep nacos

# è®¿é—® http://127.0.0.1:8848/nacos ç¡®è®¤ Nacos å·²å¯åŠ¨
```

**ç¬¬äºŒæ­¥ï¼šå¯åŠ¨ç”¨æˆ·æœåŠ¡ï¼ˆuser-serviceï¼‰**

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ IDEï¼ˆæ¨èï¼‰
# åœ¨ IDEA æˆ– Eclipse ä¸­æ‰“å¼€é¡¹ç›®
# æ‰¾åˆ°ï¼šservices/user-service/src/main/java/org/opengoofy/index12306/biz/userservice/UserServiceApplication.java
# å³é”® -> Run 'UserServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/user-service
mvn spring-boot:run
```

**å¯åŠ¨æ—¥å¿—ç¤ºä¾‹**ï¼š
```
Started UserServiceApplication in 15.234 seconds
```

**éªŒè¯**ï¼š
- æ£€æŸ¥ Nacos æ§åˆ¶å°ï¼Œåº”è¯¥èƒ½çœ‹åˆ° `index12306-user-service` å·²æ³¨å†Œ
- æœåŠ¡ç«¯å£ï¼š9001

**ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨è´­ç¥¨æœåŠ¡ï¼ˆticket-serviceï¼‰**

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ IDE
# æ‰¾åˆ°ï¼šservices/ticket-service/src/main/java/org/opengoofy/index12306/biz/ticketservice/TicketServiceApplication.java
# å³é”® -> Run 'TicketServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/ticket-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-ticket-service`
- æœåŠ¡ç«¯å£ï¼š9002

**ç¬¬å››æ­¥ï¼šå¯åŠ¨è®¢å•æœåŠ¡ï¼ˆorder-serviceï¼‰**

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ IDE
# æ‰¾åˆ°ï¼šservices/order-service/src/main/java/org/opengoofy/index12306/biz/orderservice/OrderServiceApplication.java
# å³é”® -> Run 'OrderServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/order-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-order-service`
- æœåŠ¡ç«¯å£ï¼š9003

**ç¬¬äº”æ­¥ï¼šå¯åŠ¨æ”¯ä»˜æœåŠ¡ï¼ˆpay-serviceï¼‰**

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ IDE
# æ‰¾åˆ°ï¼šservices/pay-service/src/main/java/org/opengoofy/index12306/biz/payservice/PayServiceApplication.java
# å³é”® -> Run 'PayServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/pay-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-pay-service`
- æœåŠ¡ç«¯å£ï¼š9004

**ç¬¬å…­æ­¥ï¼šå¯åŠ¨ç½‘å…³æœåŠ¡ï¼ˆgateway-serviceï¼‰**

**é‡è¦**ï¼šç½‘å…³å¿…é¡»æœ€åå¯åŠ¨ï¼Œå› ä¸ºå®ƒä¾èµ–å…¶ä»–æ‰€æœ‰æœåŠ¡ï¼

```bash
# ä¿®æ”¹ç½‘å…³é…ç½®ï¼Œä½¿ç”¨å¾®æœåŠ¡æ¨¡å¼
# ç¼–è¾‘ï¼šservices/gateway-service/src/main/resources/application.yaml
# å°† active: aggregation æ”¹ä¸º active: dev

# æ–¹å¼1ï¼šä½¿ç”¨ IDE
# æ‰¾åˆ°ï¼šservices/gateway-service/src/main/java/org/opengoofy/index12306/biz/gatewayservice/GatewayServiceApplication.java
# å³é”® -> Run 'GatewayServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/gateway-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-gateway-service`
- æœåŠ¡ç«¯å£ï¼š9000
- è®¿é—®ï¼šhttp://127.0.0.1:9000/actuator/health

#### å¾®æœåŠ¡æ¨¡å¼å¯åŠ¨é¡ºåºæ€»ç»“

```
1. Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰
   â†“
2. user-serviceï¼ˆç”¨æˆ·æœåŠ¡ï¼‰
   â†“
3. ticket-serviceï¼ˆè´­ç¥¨æœåŠ¡ï¼‰
   â†“
4. order-serviceï¼ˆè®¢å•æœåŠ¡ï¼‰
   â†“
5. pay-serviceï¼ˆæ”¯ä»˜æœåŠ¡ï¼‰
   â†“
6. gateway-serviceï¼ˆç½‘å…³æœåŠ¡ï¼‰â† æœ€åå¯åŠ¨
```

### 5.3 æ–¹å¼äºŒï¼šSpringBoot èšåˆæ¨¡å¼å¯åŠ¨

èšåˆæ¨¡å¼æ›´ç®€å•ï¼Œåªéœ€è¦å¯åŠ¨ä¸¤ä¸ªæœåŠ¡ï¼

#### å¯åŠ¨æ­¥éª¤

**ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ Nacos**
```bash
# ç¡®ä¿ Nacos æ­£åœ¨è¿è¡Œ
docker ps | grep nacos
```

**ç¬¬äºŒæ­¥ï¼šå¯åŠ¨èšåˆæœåŠ¡ï¼ˆaggregation-serviceï¼‰**

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ IDEï¼ˆæ¨èï¼‰
# æ‰¾åˆ°ï¼šservices/aggregation-service/src/main/java/org/opengoofy/index12306/biz/aggregationservice/AggregationServiceApplication.java
# å³é”® -> Run 'AggregationServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/aggregation-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-aggregation-service`
- æœåŠ¡ç«¯å£ï¼š9005

**ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨ç½‘å…³æœåŠ¡ï¼ˆgateway-serviceï¼‰**

```bash
# ç¡®ä¿ç½‘å…³é…ç½®ä½¿ç”¨èšåˆæ¨¡å¼
# ç¼–è¾‘ï¼šservices/gateway-service/src/main/resources/application.yaml
# ç¡®è®¤ active: aggregationï¼ˆé»˜è®¤å°±æ˜¯è¿™ä¸ªï¼‰

# æ–¹å¼1ï¼šä½¿ç”¨ IDE
# æ‰¾åˆ°ï¼šservices/gateway-service/src/main/java/org/opengoofy/index12306/biz/gatewayservice/GatewayServiceApplication.java
# å³é”® -> Run 'GatewayServiceApplication'

# æ–¹å¼2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ
cd services/gateway-service
mvn spring-boot:run
```

**éªŒè¯**ï¼š
- Nacos ä¸­åº”è¯¥èƒ½çœ‹åˆ° `index12306-gateway-service`
- æœåŠ¡ç«¯å£ï¼š9000

#### èšåˆæ¨¡å¼å¯åŠ¨é¡ºåºæ€»ç»“

```
1. Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰
   â†“
2. aggregation-serviceï¼ˆèšåˆæœåŠ¡ï¼‰
   â†“
3. gateway-serviceï¼ˆç½‘å…³æœåŠ¡ï¼‰
```

### 5.4 ä½¿ç”¨ IDE å¯åŠ¨ï¼ˆæ¨èï¼‰

#### IntelliJ IDEA é…ç½®

1. **å¯¼å…¥é¡¹ç›®**
   - File -> Open -> é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•
   - ç­‰å¾… Maven è‡ªåŠ¨å¯¼å…¥ä¾èµ–

2. **é…ç½® JDK**
   - File -> Project Structure -> Project
   - è®¾ç½® Project SDK ä¸º JDK 17
   - è®¾ç½® Project language level ä¸º 17

3. **å¯åŠ¨æœåŠ¡**
   - åœ¨ Project è§†å›¾ä¸­æ‰¾åˆ°å„ä¸ªæœåŠ¡çš„ Application ç±»
   - å³é”® -> Run 'XXXApplication'
   - æˆ–è€…ç‚¹å‡»ç±»åå·¦ä¾§çš„ç»¿è‰²ä¸‰è§’å½¢

4. **é…ç½®è¿è¡Œé¡ºåº**ï¼ˆå¯é€‰ï¼‰
   - Run -> Edit Configurations
   - å¯ä»¥é…ç½®å¤šä¸ªæœåŠ¡çš„å¯åŠ¨é¡ºåº

#### Eclipse é…ç½®

1. **å¯¼å…¥é¡¹ç›®**
   - File -> Import -> Existing Maven Projects
   - é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•

2. **é…ç½® JDK**
   - Project -> Properties -> Java Build Path
   - è®¾ç½® JDK ä¸º 17

3. **å¯åŠ¨æœåŠ¡**
   - æ‰¾åˆ°å„ä¸ªæœåŠ¡çš„ Application ç±»
   - å³é”® -> Run As -> Java Application

---

## å…­ã€å¯åŠ¨éªŒè¯

### 6.1 æ£€æŸ¥ Nacos æœåŠ¡æ³¨å†Œ

1. è®¿é—® Nacos æ§åˆ¶å°ï¼šhttp://127.0.0.1:8848/nacos
2. ç™»å½•ï¼ˆç”¨æˆ·å/å¯†ç ï¼šnacos/nacosï¼‰
3. è¿›å…¥"æœåŠ¡ç®¡ç† -> æœåŠ¡åˆ—è¡¨"
4. åº”è¯¥èƒ½çœ‹åˆ°ä»¥ä¸‹æœåŠ¡ï¼ˆæ ¹æ®å¯åŠ¨æ¨¡å¼ä¸åŒï¼‰ï¼š

**å¾®æœåŠ¡æ¨¡å¼**ï¼š
- index12306-user-service
- index12306-ticket-service
- index12306-order-service
- index12306-pay-service
- index12306-gateway-service

**èšåˆæ¨¡å¼**ï¼š
- index12306-aggregation-service
- index12306-gateway-service

### 6.2 æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€

#### æ–¹å¼ä¸€ï¼šé€šè¿‡ Nacos æ§åˆ¶å°
- åœ¨æœåŠ¡åˆ—è¡¨ä¸­ï¼ŒæŸ¥çœ‹æœåŠ¡çš„"å¥åº·å®ä¾‹æ•°"
- åº”è¯¥æ˜¾ç¤ºä¸º 1ï¼ˆè¡¨ç¤ºæœ‰ 1 ä¸ªå¥åº·çš„æœåŠ¡å®ä¾‹ï¼‰

#### æ–¹å¼äºŒï¼šé€šè¿‡ Actuator ç«¯ç‚¹

```bash
# æ£€æŸ¥ç½‘å…³å¥åº·çŠ¶æ€
curl http://127.0.0.1:9000/actuator/health

# æ£€æŸ¥ç”¨æˆ·æœåŠ¡å¥åº·çŠ¶æ€
curl http://127.0.0.1:9001/actuator/health

# æ£€æŸ¥è´­ç¥¨æœåŠ¡å¥åº·çŠ¶æ€
curl http://127.0.0.1:9002/actuator/health

# æ£€æŸ¥è®¢å•æœåŠ¡å¥åº·çŠ¶æ€
curl http://127.0.0.1:9003/actuator/health

# æ£€æŸ¥æ”¯ä»˜æœåŠ¡å¥åº·çŠ¶æ€
curl http://127.0.0.1:9004/actuator/health

# æ£€æŸ¥èšåˆæœåŠ¡å¥åº·çŠ¶æ€ï¼ˆèšåˆæ¨¡å¼ï¼‰
curl http://127.0.0.1:9005/actuator/health
```

**é¢„æœŸè¿”å›**ï¼š
```json
{"status":"UP"}
```

### 6.3 æµ‹è¯• API æ¥å£

#### æµ‹è¯•ç”¨æˆ·æœåŠ¡æ¥å£

```bash
# æµ‹è¯•ç”¨æˆ·æŸ¥è¯¢æ¥å£ï¼ˆé€šè¿‡ç½‘å…³ï¼‰
curl http://127.0.0.1:9000/api/user-service/query

# æˆ–è€…ç›´æ¥è®¿é—®æœåŠ¡
curl http://127.0.0.1:9001/api/user-service/query
```

#### æµ‹è¯•è´­ç¥¨æœåŠ¡æ¥å£

```bash
# æµ‹è¯•è½¦ç¥¨æŸ¥è¯¢æ¥å£ï¼ˆé€šè¿‡ç½‘å…³ï¼‰
curl http://127.0.0.1:9000/api/ticket-service/ticket/query

# æˆ–è€…ç›´æ¥è®¿é—®æœåŠ¡
curl http://127.0.0.1:9002/api/ticket-service/ticket/query
```

### 6.4 æ£€æŸ¥æ—¥å¿—

æ¯ä¸ªæœåŠ¡å¯åŠ¨åï¼Œæ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š

```
âœ… æœåŠ¡æ³¨å†ŒæˆåŠŸ
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ
âœ… Redis è¿æ¥æˆåŠŸ
âœ… RocketMQ è¿æ¥æˆåŠŸ
âœ… æœåŠ¡å¯åŠ¨å®Œæˆ
```

**ç¤ºä¾‹æ—¥å¿—**ï¼š
```
2024-01-01 10:00:00.000  INFO --- [main] o.s.c.a.n.NacosServiceRegistry : Nacos registry, index12306-user-service 127.0.0.1:9001 register finished
2024-01-01 10:00:01.000  INFO --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer : Tomcat started on port(s): 9001 (http)
2024-01-01 10:00:01.000  INFO --- [main] UserServiceApplication : Started UserServiceApplication in 15.234 seconds
```

---

## ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥

### 7.1 æœåŠ¡å¯åŠ¨å¤±è´¥

#### é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Port 9001 is already in use
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# Windowsï¼šæŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr 9001
taskkill /PID <è¿›ç¨‹ID> /F

# Linux/macOSï¼šæŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :9001
kill -9 <è¿›ç¨‹ID>
```

#### é—®é¢˜2ï¼šæ— æ³•è¿æ¥ MySQL

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Communications link failure
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ MySQL æ˜¯å¦å¯åŠ¨ï¼š`mysql -uroot -proot`
2. æ£€æŸ¥ MySQL ç«¯å£ï¼š`netstat -an | grep 3306`
3. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯
4. ç¡®è®¤æ•°æ®åº“å·²åˆ›å»º

#### é—®é¢˜3ï¼šæ— æ³•è¿æ¥ Redis

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Unable to connect to Redis
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ Redis æ˜¯å¦å¯åŠ¨ï¼š`redis-cli -h 127.0.0.1 -p 6379 -a 123456 ping`
2. æ£€æŸ¥ Redis å¯†ç æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯ 123456ï¼‰
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

#### é—®é¢˜4ï¼šæ— æ³•è¿æ¥ RocketMQ

**é”™è¯¯ä¿¡æ¯**ï¼š
```
connect to [127.0.0.1:9876] failed
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ RocketMQ NameServer æ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç«¯å£ 9876 æ˜¯å¦å¼€æ”¾
3. æ£€æŸ¥ Broker æ˜¯å¦å¯åŠ¨

#### é—®é¢˜5ï¼šæ— æ³•è¿æ¥ Nacos

**é”™è¯¯ä¿¡æ¯**ï¼š
```
failed to req API:/nacos/v1/ns/instance
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ Nacos æ˜¯å¦å¯åŠ¨ï¼šè®¿é—® http://127.0.0.1:8848/nacos
2. æ£€æŸ¥ Nacos ç”¨æˆ·åå¯†ç ï¼ˆé»˜è®¤ï¼šnacos/nacosï¼‰
3. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„ Nacos åœ°å€ï¼š`127.0.0.1:8848`

### 7.2 æœåŠ¡æ³¨å†Œå¤±è´¥

#### é—®é¢˜ï¼šæœåŠ¡æ— æ³•æ³¨å†Œåˆ° Nacos

**æ£€æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤ Nacos å·²å¯åŠ¨å¹¶å¯ä»¥è®¿é—®
2. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„ Nacos åœ°å€æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œè¿æ¥
4. æŸ¥çœ‹æœåŠ¡å¯åŠ¨æ—¥å¿—ï¼ŒæŸ¥æ‰¾é”™è¯¯ä¿¡æ¯

**å¸¸è§åŸå› **ï¼š
- Nacos æœªå¯åŠ¨
- é…ç½®æ–‡ä»¶ä¸­çš„ Nacos åœ°å€é”™è¯¯
- ç½‘ç»œé—®é¢˜
- Nacos ç”¨æˆ·åå¯†ç é”™è¯¯

### 7.3 æ•°æ®åº“ç›¸å…³é—®é¢˜

#### é—®é¢˜1ï¼šè¡¨ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Table '12306_ticket.t_train' doesn't exist
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤å·²æ‰§è¡Œ SQL åˆå§‹åŒ–è„šæœ¬
2. æ£€æŸ¥æ•°æ®åº“åç§°æ˜¯å¦æ­£ç¡®
3. é‡æ–°æ‰§è¡Œ SQL è„šæœ¬

#### é—®é¢˜2ï¼šå­—ç¬¦é›†é—®é¢˜

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Incorrect string value
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤æ•°æ®åº“å­—ç¬¦é›†ä¸º `utf8mb4`
2. é‡æ–°åˆ›å»ºæ•°æ®åº“å¹¶æŒ‡å®šå­—ç¬¦é›†

### 7.4 ä¾èµ–é—®é¢˜

#### é—®é¢˜ï¼šMaven ä¾èµ–ä¸‹è½½å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. é…ç½® Maven é•œåƒï¼ˆæ¨èä½¿ç”¨é˜¿é‡Œäº‘é•œåƒï¼‰
3. æ¸…ç†å¹¶é‡æ–°ä¸‹è½½ï¼š`mvn clean install -U`

**é…ç½® Maven é•œåƒ**ï¼ˆç¼–è¾‘ `~/.m2/settings.xml`ï¼‰ï¼š
```xml
<mirrors>
  <mirror>
    <id>aliyun</id>
    <mirrorOf>central</mirrorOf>
    <name>Aliyun Maven</name>
    <url>https://maven.aliyun.com/repository/public</url>
  </mirror>
</mirrors>
```

### 7.5 å†…å­˜ä¸è¶³

#### é—®é¢˜ï¼šå¯åŠ¨æ—¶å†…å­˜æº¢å‡º

**é”™è¯¯ä¿¡æ¯**ï¼š
```
OutOfMemoryError: Java heap space
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å¢åŠ  JVM å†…å­˜å‚æ•°
2. åœ¨ IDE ä¸­é…ç½® VM optionsï¼š`-Xms512m -Xmx1024m`
3. æˆ–è€…å‡å°‘åŒæ—¶å¯åŠ¨çš„æœåŠ¡æ•°é‡

---

## å…«ã€å¿«é€Ÿå¯åŠ¨è„šæœ¬

### 8.1 ä¸€é”®å¯åŠ¨ä¸­é—´ä»¶ï¼ˆDockerï¼‰

åˆ›å»º `start-middleware.sh`ï¼ˆLinux/macOSï¼‰æˆ– `start-middleware.bat`ï¼ˆWindowsï¼‰ï¼š

**start-middleware.sh**ï¼š
```bash
#!/bin/bash

echo "å¯åŠ¨ MySQL..."
docker run -d --name mysql-12306 -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=root \
  -e MYSQL_DATABASE=12306_ticket \
  mysql:8.0

echo "å¯åŠ¨ Redis..."
docker run -d --name redis-12306 -p 6379:6379 \
  redis:7-alpine redis-server --requirepass 123456

echo "å¯åŠ¨ RocketMQ NameServer..."
docker run -d --name rocketmq-nameserver -p 9876:9876 \
  apache/rocketmq:5.1.4 sh mqnamesrv

echo "å¯åŠ¨ RocketMQ Broker..."
docker run -d --name rocketmq-broker -p 10909:10909 -p 10911:10911 \
  -e "NAMESRV_ADDR=127.0.0.1:9876" \
  apache/rocketmq:5.1.4 sh mqbroker -n 127.0.0.1:9876

echo "å¯åŠ¨ Nacos..."
docker run -d --name nacos-server -p 8848:8848 \
  -e MODE=standalone \
  -e PREFER_HOST_MODE=hostname \
  nacos/nacos-server:v2.2.3

echo "æ‰€æœ‰ä¸­é—´ä»¶å¯åŠ¨å®Œæˆï¼"
echo "ç­‰å¾… 30 ç§’åæ£€æŸ¥çŠ¶æ€..."
sleep 30

docker ps
```

**start-middleware.bat**ï¼ˆWindowsï¼‰ï¼š
```batch
@echo off

echo å¯åŠ¨ MySQL...
docker run -d --name mysql-12306 -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=12306_ticket mysql:8.0

echo å¯åŠ¨ Redis...
docker run -d --name redis-12306 -p 6379:6379 redis:7-alpine redis-server --requirepass 123456

echo å¯åŠ¨ RocketMQ NameServer...
docker run -d --name rocketmq-nameserver -p 9876:9876 apache/rocketmq:5.1.4 sh mqnamesrv

echo å¯åŠ¨ RocketMQ Broker...
docker run -d --name rocketmq-broker -p 10909:10909 -p 10911:10911 -e "NAMESRV_ADDR=127.0.0.1:9876" apache/rocketmq:5.1.4 sh mqbroker -n 127.0.0.1:9876

echo å¯åŠ¨ Nacos...
docker run -d --name nacos-server -p 8848:8848 -e MODE=standalone -e P